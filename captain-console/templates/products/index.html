{% extends 'base.html' %}
{% load static %}
{% load url_manipulation %}
{% block content %}
    <link rel="stylesheet" href="{% static 'css/products.css' %}">
    <main>
        <div class="products {% if not products %}no-prods{% endif %}">
            {% if not products %}
            <h3>No products found...<br>sorry!</h3>
            {% endif %}
            <div class="filters">
                <form action="{{ name }}" method="get">
                    <div>
                        <input type="text" name="search">
                        <button class="btn" type="submit">Search</button>
                    </div>
                    {% if products %}
                    <button name="sort" value="price" class="sort btn" type="submit">Cheap first</button>
                    <button name="sort" value="-price" class="sort btn" type="submit">Cheap last</button>
                    <button name="sort" value="name" class="sort btn" type="submit">Alphabetical</button>
                    {% endif  %}
                </form>
                {% comment %} {% if products %} {% endcomment %}
                {% comment %} <a class="sort btn" href="{{ name }}{% query_transform sort='price' %}"> {% endcomment %}
                {% comment %}     Sort cheapest first {% endcomment %}
                {% comment %} </a> {% endcomment %}
                {% comment %} <a class="sort btn" href="{{ name }}{% query_transform sort='-price' %}"> {% endcomment %}
                {% comment %}     Sort cheapest last {% endcomment %}
                {% comment %} </a> {% endcomment %}
                {% comment %} <a class="sort btn" href="{{ name }}{% query_transform sort='name' %}"> {% endcomment %}
                {% comment %}     Sort alphabetical {% endcomment %}
                {% comment %} </a> {% endcomment %}
                {% comment %} {% endif %} {% endcomment %}
            </div>
            {% if products %}
            {% for prod in products %}
            <a href="{{ prod.get_absolute_url }}" class="product">
                <div class="img-container">
                    <img src="{% static 'img/products/'|add:prod.thumbimg %}" alt="{{ prod.name }}">
                </div>
                <div class="info">
                    <p class="title">{{ prod.name }}</p>
                    <p class="price">{{ prod.price }} kr.</p>
                </div>
                <div class="hover-info">
                    <p class="desc">{{ prod.short_desc }}</p>
                </div>
            </a>
            {% endfor %}
            {% endif %}
        </div>
        {% if products and products.paginator.num_pages != 1 %}
        <div class="pagination">
            {% if products.has_previous %}
            <a class="pagination-segment"
                href="{{ name }}{% query_transform page=products.previous_page_number %}">
                previous
            </a>
            {% else %}
            <span class="pagination-segment disabled">
                previous
            </span>
            {% endif %}
            <span class="pagination-segment">
                {{ products.number }} / {{ products.paginator.num_pages }}
            </span>
            {% if products.has_next %}
            <a class="pagination-segment"
                href="{{ name }}{% query_transform page=products.next_page_number %}">
                next
            </a>
            {% else %}
            <span class="pagination-segment disabled">
                next
            </span>
            {% endif %}
        </div>
        {% endif %}
    </main>
{% endblock %}
